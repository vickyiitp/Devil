import{R as x,I as e,Q as p,T as f,r as n,U as j}from"./index-D1Pec2V-.js";import{A as v,c as m}from"./cms-66TvDIJ4.js";import{r as w}from"./resolveMedia-C_HTZBoC.js";class y extends x.Component{constructor(){super(...arguments),this.state={hasError:!1}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,t){console.error("ErrorBoundary caught error:",a,t)}render(){return this.state.hasError?e.jsxs("div",{className:"pt-24 pb-12 text-center text-devil-red",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Something went wrong"}),e.jsx("p",{children:"We couldn't load this page; try refreshing or report the issue."})]}):this.props.children}}const _=()=>{var l;const{slug:s}=p(),a=f(),[t,o]=n.useState(null),[u,h]=n.useState(!0),[i,g]=n.useState(null);return n.useEffect(()=>{if(!s)return;const c=new URLSearchParams(a.search).get("preview")==="1";(async()=>{try{console.debug(`Fetching blog by slug: ${s} (preview=${c})`);let r;if(c){const d=localStorage.getItem("admin_token");if(!d)throw new Error("Preview requires admin authentication");r=await m.getAdminBlogBySlug(s,d)}else r=await m.getBlogBySlug(s);r.content&&(r.content=w(r.content)),o(r)}catch(r){console.error(`Failed to fetch blog post with slug ${s}:`,r),g(r instanceof Error?r.message:"Could not load blog post."),r instanceof Error&&r.message==="Post not found"&&o(null)}finally{h(!1)}})()},[s,a.search]),u?e.jsx("div",{className:"pt-24 pb-12 text-center",children:"Loading post..."}):i?e.jsx("div",{className:"pt-24 pb-12 text-center text-devil-red",children:i}):t?e.jsx(y,{children:e.jsx("div",{className:"pt-24 pb-12",children:e.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs("article",{children:[e.jsxs("header",{className:"text-center mb-12",children:[e.jsx("p",{className:"text-devil-red font-mono",children:new Date(t.published_at||t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}),e.jsx("h1",{className:"mt-4 text-4xl md:text-6xl font-black text-devil-light tracking-tight",children:t.title}),e.jsxs("p",{className:"mt-2 text-gray-400",children:["By ",t.author]}),e.jsxs("div",{className:"mt-6 flex justify-center gap-4 text-gray-400",children:[e.jsxs("span",{children:["üëÅÔ∏è ",t.views," views"]}),e.jsxs("span",{children:["‚ù§Ô∏è ",t.likes," likes"]}),t.read_time&&e.jsxs("span",{children:["üìñ ",t.read_time," min read"]})]})]}),t.featured_image&&e.jsx("img",{src:(l=t.featured_image)!=null&&l.startsWith("http")?t.featured_image:`${v}${t.featured_image}`,alt:t.title,className:"w-full h-auto rounded-lg shadow-lg mb-12"}),e.jsx("div",{className:"prose prose-invert prose-lg max-w-none",dangerouslySetInnerHTML:{__html:t.content}})]})})})})}):e.jsx(j,{to:"/blog"})};export{_ as default};
